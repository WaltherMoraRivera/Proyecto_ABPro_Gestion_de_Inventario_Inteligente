# GuÃ­a de Uso: Exportar Base de Datos

## DescripciÃ³n General

La funcionalidad **"Exportar Base de Datos"** permite guardar todos los productos actuales del inventario en un archivo Excel. Este archivo estÃ¡ completamente compatible con la funciÃ³n "Cargar Excel", lo que permite un workflow completo de exportaciÃ³n e importaciÃ³n de datos.

## Acceso a la Funcionalidad

**UbicaciÃ³n**: Barra superior de la aplicaciÃ³n, botÃ³n **"ğŸ’¾ Exportar Base de Datos"** (a la izquierda del botÃ³n "Cargar Excel")

## Workflow Completo de Trabajo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SESIÃ“N 1                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Cargar Excel con datos iniciales                        â”‚
â”‚     â””â”€â–º Usar "ğŸ“ Cargar Excel"                             â”‚
â”‚                                                             â”‚
â”‚  2. Trabajar con los productos                              â”‚
â”‚     â”œâ”€â–º Agregar nuevos productos                           â”‚
â”‚     â”œâ”€â–º Modificar productos existentes                     â”‚
â”‚     â”œâ”€â–º Registrar entradas/salidas                         â”‚
â”‚     â””â”€â–º Realizar cualquier cambio necesario                â”‚
â”‚                                                             â”‚
â”‚  3. Exportar todo el trabajo                                â”‚
â”‚     â””â”€â–º Usar "ğŸ’¾ Exportar Base de Datos"                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    [Archivo Excel guardado]
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SESIÃ“N 2 (Otro dÃ­a, otra computadora, etc.)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Cargar el archivo exportado anteriormente               â”‚
â”‚     â””â”€â–º Usar "ğŸ“ Cargar Excel"                             â”‚
â”‚                                                             â”‚
â”‚  2. Continuar trabajando desde donde quedÃ³                  â”‚
â”‚     â””â”€â–º Todos los datos se restauran exactamente           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## CÃ³mo Usar la FunciÃ³n

### Paso 1: Tener Productos en el Inventario

La funciÃ³n requiere que haya al menos un producto en el inventario. Puede:
- Cargar productos desde Excel
- Agregar productos manualmente
- Tener productos de sesiones anteriores

### Paso 2: Hacer Clic en "Exportar Base de Datos"

1. Localizar el botÃ³n **"ğŸ’¾ Exportar Base de Datos"** en la barra superior
2. Hacer clic en el botÃ³n
3. Se abrirÃ¡ un diÃ¡logo para guardar el archivo

### Paso 3: Seleccionar UbicaciÃ³n y Nombre

El diÃ¡logo de guardado permite:
- **Elegir la carpeta** donde guardar el archivo
- **Cambiar el nombre** del archivo (por defecto: `inventario_exportado.xlsx`)
- **Confirmar o cancelar** la operaciÃ³n

### Paso 4: ConfirmaciÃ³n

Si la exportaciÃ³n es exitosa, aparecerÃ¡ un mensaje mostrando:
- âœ“ Nombre del archivo guardado
- âœ“ Cantidad de productos exportados
- âœ“ Nota sobre compatibilidad con "Cargar Excel"

**Ejemplo de mensaje:**
```
Base de datos exportada exitosamente.

Archivo: inventario_exportado.xlsx
Productos exportados: 15

Puede usar este archivo con la opciÃ³n 'Cargar Excel'
para restaurar estos datos en una nueva sesiÃ³n.
```

## Estructura del Archivo Exportado

El archivo Excel generado contiene **10 columnas** con toda la informaciÃ³n de los productos:

| Columna | DescripciÃ³n | Ejemplo |
|---------|-------------|---------|
| **ID** | Identificador Ãºnico del producto | 1 |
| **Numero_Item** | CÃ³digo de 6 dÃ­gitos | 100001 |
| **Codigo_UPC** | CÃ³digo de barras universal | 012345678901 |
| **BIN_Bodega** | UbicaciÃ³n en bodega | 001/020/006 |
| **Nombre** | Nombre del producto | Laptop HP 15 |
| **Precio** | Precio unitario | 899.99 |
| **Stock_Actual** | Cantidad actual en inventario | 15 |
| **Stock_Minimo** | Stock mÃ­nimo permitido | 5 |
| **Stock_Maximo** | Stock mÃ¡ximo permitido | 50 |
| **Categoria** | CategorÃ­a del producto | ElectrÃ³nica |

**Importante**: Los nombres de las columnas siguen exactamente el formato esperado por "Cargar Excel" con mapeo automÃ¡tico.

## Casos de Uso

### 1. Respaldo PeriÃ³dico
**SituaciÃ³n**: Quiere guardar el estado actual del inventario como respaldo.

**Pasos**:
1. Hacer clic en "Exportar Base de Datos"
2. Guardar con nombre descriptivo: `inventario_backup_2025-12-16.xlsx`
3. Guardar en carpeta de respaldos

**Beneficio**: Puede restaurar el inventario a este punto en cualquier momento.

---

### 2. Fin de Jornada/SesiÃ³n
**SituaciÃ³n**: Ha trabajado todo el dÃ­a agregando/modificando productos y necesita guardar el progreso.

**Pasos**:
1. Al finalizar el trabajo, exportar base de datos
2. Guardar como: `inventario_2025-12-16_final.xlsx`
3. Al dÃ­a siguiente, cargar este archivo para continuar

**Beneficio**: No pierde ningÃºn trabajo realizado.

---

### 3. Transferencia entre Computadoras
**SituaciÃ³n**: TrabajÃ³ en una computadora y necesita continuar en otra.

**Pasos**:
1. En la primera PC: Exportar base de datos
2. Transferir archivo (USB, correo, nube, etc.)
3. En la segunda PC: Cargar el archivo exportado

**Beneficio**: Movilidad total del trabajo.

---

### 4. Compartir Inventario
**SituaciÃ³n**: Necesita enviar el inventario actual a un colega o supervisor.

**Pasos**:
1. Exportar base de datos
2. Enviar el archivo Excel generado
3. El receptor puede abrirlo en Excel o cargarlo en la aplicaciÃ³n

**Beneficio**: FÃ¡cil comparticiÃ³n de datos.

---

### 5. AuditorÃ­a/Snapshots
**SituaciÃ³n**: Necesita mantener registros del estado del inventario en momentos especÃ­ficos.

**Pasos**:
1. Al final de cada mes/semana, exportar base de datos
2. Guardar con fecha: `inventario_2025-12_cierre_mes.xlsx`
3. Mantener archivos histÃ³ricos

**Beneficio**: Registro histÃ³rico para anÃ¡lisis y auditorÃ­as.

---

### 6. MigraciÃ³n de Datos
**SituaciÃ³n**: Necesita mover datos a una nueva instalaciÃ³n de la aplicaciÃ³n.

**Pasos**:
1. En instalaciÃ³n antigua: Exportar base de datos
2. Instalar aplicaciÃ³n en nuevo sistema
3. Cargar archivo exportado

**Beneficio**: MigraciÃ³n sin pÃ©rdida de datos.

---

## Compatibilidad con "Cargar Excel"

El archivo exportado estÃ¡ diseÃ±ado para ser **100% compatible** con la funciÃ³n "Cargar Excel":

âœ… **Nombres de columnas correctos**: Coinciden exactamente con los esperados  
âœ… **Formato de datos**: Tipos de datos correctos (nÃºmeros, texto)  
âœ… **Estructura**: Una fila por producto, encabezados en primera fila  
âœ… **CodificaciÃ³n**: Compatible con diferentes sistemas  
âœ… **BIN incluido**: Mantiene la informaciÃ³n de ubicaciones de bodega

### Flujo de Carga del Archivo Exportado

1. Abrir la aplicaciÃ³n
2. Clic en "ğŸ“ Cargar Excel"
3. Seleccionar el archivo previamente exportado
4. En el diÃ¡logo de mapeo:
   - Mapear `ID` â†’ `ID`
   - Mapear `Numero_Item` â†’ `Numero_Item`
   - Mapear `Codigo_UPC` â†’ `Codigo_UPC`
   - Mapear `BIN_Bodega` â†’ `BIN_Bodega`
   - Mapear las demÃ¡s columnas segÃºn corresponda
5. Cargar datos
6. âœ“ Todos los productos se restauran exactamente como estaban

## Validaciones y Manejo de Errores

### ValidaciÃ³n: Inventario VacÃ­o
**SituaciÃ³n**: No hay productos en el inventario.

**Comportamiento**:
```
âš ï¸ Sin Datos

No hay productos en el inventario para exportar.
```

**SoluciÃ³n**: Agregar o cargar productos antes de exportar.

---

### ValidaciÃ³n: Error al Guardar
**SituaciÃ³n**: No se puede escribir el archivo (permisos, espacio, etc.).

**Comportamiento**:
```
âŒ Error al Exportar

No se pudo exportar la base de datos:
[Mensaje de error especÃ­fico]
```

**Soluciones**:
- Verificar permisos de escritura en la carpeta
- Verificar espacio disponible en disco
- Cerrar el archivo si estÃ¡ abierto en Excel
- Seleccionar otra ubicaciÃ³n

---

### ValidaciÃ³n: CancelaciÃ³n
**SituaciÃ³n**: Usuario cancela el diÃ¡logo de guardado.

**Comportamiento**: La funciÃ³n termina sin hacer nada, sin mensajes de error.

---

## Diferencias con "Agregar Producto" y "Modificar Producto"

| FunciÃ³n | PropÃ³sito | Alcance |
|---------|-----------|---------|
| **Agregar Producto** | Crear UN producto nuevo | 1 producto a la vez |
| **Modificar Producto** | Editar UN producto existente | 1 producto a la vez |
| **Exportar Base de Datos** | Guardar TODOS los productos | TODO el inventario |

**Exportar Base de Datos** es una operaciÃ³n masiva que guarda el estado completo del sistema.

## Formato TÃ©cnico del Archivo

### CaracterÃ­sticas del Excel Generado

- **Formato**: `.xlsx` (Excel 2007+)
- **Hoja**: Nombre `Inventario`
- **Encabezados**: Primera fila
- **Ãndice**: No incluido (sin columna de nÃºmeros de fila)
- **CodificaciÃ³n**: UTF-8
- **Separadores**: AutomÃ¡ticos segÃºn Excel

### Ejemplo de Contenido

```
ID | Numero_Item | Codigo_UPC    | BIN_Bodega  | Nombre        | Precio | Stock_Actual | Stock_Minimo | Stock_Maximo | Categoria
---|-------------|---------------|-------------|---------------|--------|--------------|--------------|--------------|------------
1  | 100001      | 012345678901  | 001/020/006 | Laptop HP 15  | 899.99 | 15           | 5            | 50           | ElectrÃ³nica
2  | 100001      | 012345678901  | 002/015/003 | Laptop HP 15  | 899.99 | 10           | 5            | 50           | ElectrÃ³nica
3  | 100002      | 012345678902  | 001/020/007 | Mouse Wireless| 29.99  | 45           | 20           | 100          | Accesorios
```

## Mejores PrÃ¡cticas

### 1. Nomenclatura de Archivos
Use nombres descriptivos que incluyan:
- Fecha: `inventario_2025-12-16.xlsx`
- PropÃ³sito: `inventario_backup_mensual.xlsx`
- VersiÃ³n: `inventario_v2.xlsx`

### 2. Frecuencia de ExportaciÃ³n
Exporte regularmente:
- **Diariamente**: Si hay cambios frecuentes
- **Semanalmente**: Para inventarios estables
- **Antes de cambios importantes**: PrevenciÃ³n

### 3. OrganizaciÃ³n
Mantenga una estructura de carpetas:
```
/Respaldos_Inventario/
  â”œâ”€ 2025/
  â”‚  â”œâ”€ Diciembre/
  â”‚  â”‚  â”œâ”€ inventario_2025-12-01.xlsx
  â”‚  â”‚  â”œâ”€ inventario_2025-12-15.xlsx
  â”‚  â”‚  â””â”€ inventario_2025-12-31.xlsx
  â”‚  â””â”€ Noviembre/
  â””â”€ Anteriores/
```

### 4. VerificaciÃ³n Post-ExportaciÃ³n
DespuÃ©s de exportar:
1. âœ“ Verificar que el archivo se creÃ³
2. âœ“ Comprobar el tamaÃ±o del archivo (no estÃ¡ vacÃ­o)
3. âœ“ Abrir en Excel para validar contenido
4. âœ“ Opcional: Cargar en otra instancia de la app para verificar

### 5. Respaldos MÃºltiples
- Mantenga al menos 3 versiones histÃ³ricas
- Guarde copias en diferentes ubicaciones
- Considere respaldos en la nube

## SoluciÃ³n de Problemas

### Problema: "No hay productos en el inventario para exportar"
**Causa**: El inventario estÃ¡ vacÃ­o.  
**SoluciÃ³n**: Cargar o agregar productos primero.

---

### Problema: El archivo exportado no se puede cargar
**Causa**: Archivo corrupto o daÃ±ado.  
**SoluciÃ³n**: 
1. Exportar nuevamente
2. Verificar que Excel puede abrir el archivo
3. Revisar que tiene las 10 columnas esperadas

---

### Problema: Falta informaciÃ³n en el archivo exportado
**Causa**: Productos con atributos vacÃ­os o "N/D".  
**SoluciÃ³n**: Los valores "N/D" se exportan tal cual, son vÃ¡lidos.

---

### Problema: El archivo es demasiado grande
**Causa**: Muchos productos en el inventario.  
**SoluciÃ³n**: 
1. Normal para inventarios grandes
2. Considere exportar por categorÃ­as (futura funcionalidad)
3. Comprimir el archivo .xlsx en .zip para transferencia

---

## Testing

Se incluye un script de pruebas: `test_exportar_bd.py`

**Para ejecutarlo**:
```bash
python test_exportar_bd.py
```

**El script verifica**:
- âœ“ ExportaciÃ³n exitosa de productos
- âœ“ Archivo contiene 10 columnas correctas
- âœ“ Compatibilidad con "Cargar Excel"
- âœ“ Carga simulada funciona
- âœ“ Integridad de datos exportados/importados

## Notas TÃ©cnicas

### ImplementaciÃ³n

**Archivo**: `gui.py`  
**FunciÃ³n**: `exportar_base_datos()`  
**UbicaciÃ³n botÃ³n**: LÃ­nea ~123 en `titulo_frame`

**LibrerÃ­as usadas**:
- `pandas`: Para crear DataFrame y exportar a Excel
- `tkinter.filedialog`: Para diÃ¡logo de guardar archivo
- `tkinter.messagebox`: Para mensajes de confirmaciÃ³n/error

**CÃ³digo simplificado**:
```python
def exportar_base_datos(self):
    # 1. Validar que hay productos
    if not self.inventario.productos:
        return
    
    # 2. Solicitar ubicaciÃ³n de guardado
    archivo = filedialog.asksaveasfilename(...)
    
    # 3. Crear lista de diccionarios con datos
    datos = [{'ID': p.id, 'Nombre': p.nombre, ...} for p in productos]
    
    # 4. Crear DataFrame y exportar
    df = pd.DataFrame(datos)
    df.to_excel(archivo, index=False)
    
    # 5. Confirmar Ã©xito
    messagebox.showinfo("Ã‰xito", ...)
```

### Formato de Datos

```python
datos_productos = [{
    'ID': int,
    'Numero_Item': str,
    'Codigo_UPC': str,
    'BIN_Bodega': str,
    'Nombre': str,
    'Precio': float,
    'Stock_Actual': int,
    'Stock_Minimo': int,
    'Stock_Maximo': int,
    'Categoria': str
}]
```

---

**VersiÃ³n**: 2.2.0  
**Fecha**: Diciembre 2025  
**Autor**: Sistema de GestiÃ³n de Inventario Inteligente
